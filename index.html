<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" /> <title>RPS Dual Mode ‚Äî Play + Sandbox</title> <meta name="theme-color" content="#0b1220" /> <style> /* Design tokens and theming */ :root{ color-scheme: light dark; --bg:#070b14; --bg2:#0b1220; --panel:#0e1628; --panel2:#0c1426; --text:#e6e9ef; --muted:#9aa3b2; --ring:rgba(99,179,237,.5); --accent:#7dd3fc; --accent2:#a78bfa; --win:#34d399; --lose:#f87171; --draw:#fbbf24; --rock:#8b95a1; --paper:#9ed0ff; --scissors:#f5a3c7; --pad:clamp(14px,3.2vw,24px); --gap:clamp(12px,2.6vw,20px); --radius:16px; --shadow:0 12px 36px rgba(0,0,0,.35); --soft:0 8px 24px rgba(0,0,0,.25); --fs-xl:clamp(20px,3.8vw,34px); --fs-lg:clamp(16px,2.6vw,20px); --fs-md:clamp(14px,2.2vw,18px); --fs-sm:clamp(12px,1.8vw,14px); --btn-size:clamp(64px,16vw,104px); } /* Light theme defaults via prefers-color-scheme, can be overridden by JS toggle */ @media (prefers-color-scheme: light){ :root{ --bg:#f6f8fb; --bg2:#fbfdff; --panel:#ffffff; --panel2:#f3f6fb; --text:#0b1220; --muted:#52607a; --ring:rgba(56,132,255,.35); --accent:#007aff; --accent2:#7c3aed; --rock:#68707b; --paper:#3b82f6; --scissors:#db2777; --shadow:0 10px 30px rgba(0,0,0,.08); --soft:0 8px 24px rgba(0,0,0,.08); } } *{box-sizing:border-box} html,body{height:100%} body{ margin:0; color:var(--text); font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif; background: radial-gradient(1200px 800px at 10% 0%, color-mix(in oklab, var(--bg) 75%, transparent), transparent 60%), radial-gradient(1200px 800px at 90% 0%, color-mix(in oklab, var(--bg2) 65%, transparent), transparent 60%), var(--bg); padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; } /* Floating aurora background */ .aurora{ position:fixed;inset:-20vmax;pointer-events:none;z-index:-1;filter:blur(40px) saturate(130%); background: radial-gradient(35vmax 35vmax at 20% 30%, color-mix(in oklab, var(--accent2) 35%, transparent), transparent 60%), radial-gradient(30vmax 30vmax at 80% 20%, color-mix(in oklab, var(--accent) 35%, transparent), transparent 60%), radial-gradient(40vmax 40vmax at 50% 80%, color-mix(in oklab, #ec4899 30%, transparent), transparent 60%); animation:aurora 25s ease-in-out infinite alternate; } @keyframes aurora{ 0%{transform:translate3d(0,0,0) rotate(0.2deg)} 100%{transform:translate3d(2vmax,-1vmax,0) rotate(-0.2deg)} } /* App shell */ .app{ width:min(1040px,95vw); margin-inline:auto; background:linear-gradient(180deg,color-mix(in oklab, var(--panel) 96%, black 4%), var(--bg2)); border:1px solid color-mix(in oklab, var(--panel) 70%, black 30%); border-radius:calc(var(--radius) + 6px); box-shadow:var(--shadow); overflow:hidden; } /* Header */ header{ display:flex;align-items:center;justify-content:space-between; gap:var(--gap);padding:var(--pad); background:linear-gradient(180deg, color-mix(in oklab, var(--panel) 90%, black 10%), color-mix(in oklab, var(--panel2) 90%, black 10%)); border-bottom:1px solid color-mix(in oklab, var(--panel) 70%, black 30%); } .brand{display:flex;align-items:center;gap:12px} .logo{ width:38px;height:38px;border-radius:12px;display:grid;place-items:center; background:radial-gradient(circle at 30% 30%, color-mix(in oklab, var(--panel2) 90%, black 10%), var(--bg)); border:1px solid color-mix(in oklab, var(--panel) 70%, black 30%);color:var(--accent2);font-weight:800; box-shadow:inset 0 0 0 1px color-mix(in oklab, var(--bg) 90%, black 10%), var(--soft); } h1{margin:0;font-size:var(--fs-xl);letter-spacing:.3px} .tabbar{display:flex;gap:8px;flex-wrap:wrap} .tab{ appearance:none;border:none;cursor:pointer; padding:10px 14px;border-radius:12px;font-size:var(--fs-sm); background:color-mix(in oklab, var(--panel2) 90%, black 10%);color:var(--text);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%); } .tab.active{background:color-mix(in oklab, var(--panel2) 80%, black 20%);border-color:color-mix(in oklab, var(--panel) 50%, black 50%);box-shadow:0 0 0 3px var(--ring) inset} /* Main grid */ main{display:grid;gap:var(--gap);padding:calc(var(--pad) + 6px)} .panel{ background:linear-gradient(180deg, var(--panel) 0%, var(--panel2) 100%); border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);border-radius:var(--radius);padding:var(--pad);box-shadow:var(--soft); } /* Play mode components */ .grid-2{display:grid;grid-template-columns:1.1fr .9fr;gap:var(--gap)} @media (max-width:820px){.grid-2{grid-template-columns:1fr}} .hint{color:var(--muted);font-size:var(--fs-sm)} .score{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;text-align:center} .score .box{background:color-mix(in oklab, var(--panel2) 90%, black 10%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);border-radius:12px;padding:12px} .score .num{font-size:clamp(22px,4.4vw,36px);font-weight:800} .score .lbl{color:var(--muted);font-size:var(--fs-sm)} .result{margin-top:10px;padding:12px;border-radius:12px;border:1px dashed color-mix(in oklab, var(--panel) 55%, black 45%);background:color-mix(in oklab, var(--panel2) 85%, black 15%);min-height:48px} .result.win{border-color:rgba(52,211,153,.45);background:rgba(52,211,153,.08);color:var(--win)} .result.lose{border-color:rgba(248,113,113,.45);background:rgba(248,113,113,.08);color:var(--lose)} .result.draw{border-color:rgba(251,191,36,.45);background:rgba(251,191,36,.08);color:var(--draw)} .actions{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--gap);place-items:center;padding:var(--pad)} .btn{ width:100%;max-width:var(--btn-size);aspect-ratio:1/1;display:grid;place-items:center; background:linear-gradient(180deg, color-mix(in oklab, var(--panel2) 92%, black 8%), color-mix(in oklab, var(--panel) 92%, black 8%));color:var(--text); border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);border-radius:18px;font-size:clamp(28px,6vw,42px); cursor:pointer;transition:transform .09s ease, background .25s ease, box-shadow .25s ease, border-color .25s ease; box-shadow:var(--soft);user-select:none;-webkit-tap-highlight-color:transparent } .btn:hover{background:color-mix(in oklab, var(--panel2) 80%, black 20%)} .btn:active{transform:translateY(1px) scale(.99)} .btn:focus-visible{outline:none;box-shadow:0 0 0 3px var(--ring)} .pickwrap{display:grid;grid-template-columns:1fr auto 1fr;gap:12px;place-items:center;padding:var(--pad)} .pick{ font-size:clamp(40px,8vw,64px);display:grid;place-items:center; width:clamp(64px,15vw,96px);aspect-ratio:1/1;border-radius:16px;background:color-mix(in oklab, var(--panel2) 92%, black 8%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%) } .vs{font-weight:800;color:var(--muted);letter-spacing:1px} /* History */ .history{margin-top:12px;max-height:240px;overflow:auto;padding-right:4px;scrollbar-width:thin} .item{display:grid;grid-template-columns:1fr auto 1fr;gap:10px;align-items:center;padding:10px;margin-bottom:8px;background:color-mix(in oklab, var(--panel2) 92%, black 8%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);border-radius:10px;font-size:var(--fs-sm)} .tag{padding:2px 8px;border-radius:999px;font-weight:700} .tag.win{background:rgba(52,211,153,.15);color:var(--win);border:1px solid rgba(52,211,153,.35)} .tag.lose{background:rgba(248,113,113,.15);color:var(--lose);border:1px solid rgba(248,113,113,.35)} .tag.draw{background:rgba(251,191,36,.15);color:var(--draw);border:1px solid rgba(251,191,36,.35)} /* Footer actions */ .footer{display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center;padding:var(--pad);border-top:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);background:color-mix(in oklab, var(--panel2) 92%, black 8%)} .secondary{background:transparent;border:1px solid color-mix(in oklab, var(--panel) 55%, black 45%);color:var(--text);padding:10px 14px;border-radius:10px;font-size:var(--fs-sm);cursor:pointer} .secondary:focus-visible{box-shadow:0 0 0 3px var(--ring)} /* Sandbox Area */ .sandbox-wrap{display:grid;gap:var(--gap)} .sbx-controls{display:flex;flex-wrap:wrap;gap:10px} .sbx-controls .chip{ background:color-mix(in oklab, var(--panel2) 92%, black 8%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);color:var(--text);padding:10px 12px;border-radius:12px;font-size:var(--fs-sm);cursor:pointer } .sbx-controls .chip:focus-visible{box-shadow:0 0 0 3px var(--ring)} .sbx-stats{display:flex;gap:12px;flex-wrap:wrap;color:var(--muted);font-size:var(--fs-sm)} .canvas-host{ position:relative;height:min(60vh,520px);border-radius:16px; background:radial-gradient(120% 120% at 30% 20%, color-mix(in oklab, var(--panel) 85%, black 15%), var(--bg)); border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);overflow:hidden } canvas{display:block;width:100%;height:100%} .badge{position:absolute;inset:auto 12px 12px auto;padding:6px 10px;border-radius:999px;background:color-mix(in oklab, var(--panel2) 92%, black 8%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);color:var(--muted);font-size:var(--fs-sm)} .particles{position:absolute;inset:0;pointer-events:none} /* Motion preferences */ @media (prefers-reduced-motion:reduce){ .btn,.result{transition:none} .aurora{animation:none} } .sr-only{position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0} </style> </head>
<body> <div class="aurora" aria-hidden="true"></div> <div class="app" role="application" aria-label="RPS Dual Mode"> <header> <div class="brand"> <div class="logo">RPS</div> <h1>Rock - Paper - Scissors ‚Äî Dual Mode</h1> </div> <nav class="tabbar" role="tablist" aria-label="Mode Switcher"> <button class="tab active" role="tab" aria-selected="true" aria-controls="tab-play" id="tabbtn-play">Play</button> <button class="tab" role="tab" aria-selected="false" aria-controls="tab-sandbox" id="tabbtn-sandbox">Sandbox</button> </nav> </header> <main> <!-- PLAY TAB --> <section id="tab-play" class="panel" role="tabpanel" aria-labelledby="tabbtn-play"> <div class="grid-2"> <div> <div class="hint" style="margin-bottom:10px">Tap an emoji to play. Great on mobile.</div> <div class="score" aria-live="polite"> <div class="box"><div class="num" id="pScore">0</div><div class="lbl">Player</div></div> <div class="box"><div class="num" id="rounds">0</div><div class="lbl">Rounds</div></div> <div class="box"><div class="num" id="cScore">0</div><div class="lbl">Computer</div></div> </div> <div id="playResult" class="result" aria-live="polite"></div> <div class="history" id="playHistory" aria-live="polite" aria-label="Round History"></div> </div> <div> <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:10px"> <label class="sr-only" for="mode">Mode</label> <select id="mode" style="background:color-mix(in oklab, var(--panel2) 92%, black 8%);border:1px solid color-mix(in oklab, var(--panel) 60%, black 40%);color:var(--text);padding:10px 12px;border-radius:12px;font-size:var(--fs-sm);outline:none"> <option value="pvc" selected>Player vs Computer</option> <option value="bo3">Best of 3</option> <option value="bo5">Best of 5</option> </select> <button id="reset" class="secondary" type="button">Reset</button> <button id="undo" class="secondary" type="button">Undo</button> </div> <div class="actions"> <button class="btn move" data-move="rock" title="Rock">ü™®</button> <button class="btn move" data-move="paper" title="Paper">üìÑ</button> <button class="btn move" data-move="scissors" title="Scissors">‚úÇÔ∏è</button> </div> <div class="pickwrap"> <div class="pick" id="pPick" aria-live="polite">‚ùî</div> <div class="vs">VS</div> <div class="pick" id="cPick" aria-live="polite">‚ùî</div> </div> </div> </div> </section>
<!-- SANDBOX TAB -->
<section id="tab-sandbox" class="panel" role="tabpanel" aria-labelledby="tabbtn-sandbox" hidden>
  <div class="sandbox-wrap">
    <div class="sbx-controls" aria-label="Sandbox Controls">
      - <button class="chip" data-spawn="rock">Spawn Rock ü™®</button>
      - <button class="chip" data-spawn="paper">Spawn Paper üìÑ</button>
      - <button class="chip" data-spawn="scissors">Spawn Scissors ‚úÇÔ∏è</button>
      - <button class="chip" id="autoToggle">Auto CPU: Off</button>
      - <button class="chip" id="pause">Pause</button>
      - <button class="chip" id="clear">Clear</button>
      <label class="chip" style="display:flex;align-items:center;gap:8px">
        Speed <input id="speed" type="range" min="0.2" max="2.0" step="0.1" value="1" />
      </label>
    </div>
    <div class="sbx-stats" id="stats">Wins: 0 -  Draws: 0 -  Objects: 0</div>
    <div class="canvas-host" id="arena">
      <canvas id="sandbox"></canvas>
      <canvas class="particles" id="fx"></canvas>
      <div class="badge">Drag & fling tokens. Collisions resolve with effects.</div>
    </div>
  </div>
</section>
</main> <div class="footer"> <span class="hint">Tip: r/p/s keys work in Play. In Sandbox, long-press to grab on touch.</span> <div style="display:flex;gap:10px;align-items:center"> <button id="theme" class="secondary">Toggle Theme</button> </div> </div> </div>
<script> (() => { // Query helpers const $ = sel => document.querySelector(sel); const $$ = sel => Array.from(document.querySelectorAll(sel)); const clamp = (v,min,max)=>Math.max(min,Math.min(max,v)); // Tab switcher const tabs = { play: $("#tab-play"), sandbox: $("#tab-sandbox") }; const tabBtns = { play: $("#tabbtn-play"), sandbox: $("#tabbtn-sandbox") }; function showTab(key){ for(const k in tabs){ const active = k===key; tabs[k].hidden = !active; tabBtns[k].classList.toggle("active", active); tabBtns[k].setAttribute("aria-selected", active ? "true":"false"); } } tabBtns.play.addEventListener("click", ()=>showTab("play")); tabBtns.sandbox.addEventListener("click", ()=>showTab("sandbox")); // Theme: auto from prefers-color-scheme; toggle persists override const THEME_KEY = "rps-theme-override"; // "light" | "dark" | null function applyTheme(){ const over = localStorage.getItem(THEME_KEY); const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches; const isDark = over ? (over==="dark") : prefersDark; document.documentElement.dataset.theme = isDark ? "dark" : "light"; // We do not invert. Styles are token-based, so just switch data attr if needed for future } applyTheme(); $("#theme").addEventListener("click", ()=>{ const curr = document.documentElement.dataset.theme || (window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"); const next = curr==="dark" ? "light" : "dark"; localStorage.setItem(THEME_KEY, next); applyTheme(); }); // PLAY MODE const icons = { rock:"ü™®", paper:"üìÑ", scissors:"‚úÇÔ∏è" }; const moves = Object.keys(icons); const el = { mode: $("#mode"), reset: $("#reset"), undo: $("#undo"), pScore: $("#pScore"), cScore: $("#cScore"), rounds: $("#rounds"), res: $("#playResult"), hist: $("#playHistory"), pPick: $("#pPick"), cPick: $("#cPick") }; let st = { p:0, c:0, r:0, stack:[], target:null, locked:false }; function setMode(v){ st.target = v==="bo3" ? 2 : v==="bo5" ? 3 : null; st.locked = false; setMsg(v==="pvc" ? "Player vs Computer. Make your move!" : `Best of ${st.target*2-1}. First to ${st.target} wins!`); } function decide(p,c){ if(p===c) return "draw"; if((p==="rock"&&c==="scissors")||(p==="paper"&&c==="rock")||(p==="scissors"&&c==="paper")) return "win"; return "lose"; } function setMsg(t,kind){ el.res.className="result"; if(kind) el.res.classList.add(kind); el.res.textContent=t; } function renderScore(){ el.pScore.textContent = st.p; el.cScore.textContent = st.c; el.rounds.textContent = st.r; } function historyItem(outcome,p,c){ const div=document.createElement("div");div.className="item"; const tag=document.createElement("span");tag.className=`tag ${outcome}`;tag.textContent=outcome.toUpperCase(); const l=document.createElement("div");l.textContent=`You: ${p} ${icons[p]}`; const r=document.createElement("div");r.style.textAlign="right";r.textContent=`CPU: ${c} ${icons[c]}`; div.append(l,tag,r); el.hist.prepend(div); } function playRound(p){ if(st.locked) return; const c = moves[Math.random()*3|0]; el.pPick.textContent=icons[p]; el.cPick.textContent=icons[c]; const out = decide(p,c); st.r++; if(out==="win") st.p++; if(out==="lose") st.c++; st.stack.push({p,c,out}); const line = out==="win" ? `You win! ${p} beats ${c}.` : out==="lose" ? `You lose. ${c} beats ${p}.` : `It's a draw. ${p} = ${c}.`; setMsg(line, out); historyItem(out,p,c); // Center burst on outcome if(out==="win") centerBurst("#34d399"); else if(out==="lose") centerBurst("#f87171"); else centerBurst("#fbbf24"); if(st.target!=null && (st.p>=st.target || st.c>=st.target)){ st.locked=true; setTimeout(()=>setMsg(st.p>st.c?"You win the match! üèÜ":"Computer wins the match! ü§ñ", st.p>st.c?"win":"lose"),60); } renderScore(); } $$(".move").forEach(b=>b.addEventListener("click",()=>playRound(b.dataset.move))); window.addEventListener("keydown",(e)=>{ const k=e.key.toLowerCase(); if(k==="r") playRound("rock"); if(k==="p") playRound("paper"); if(k==="s") playRound("scissors"); }); el.mode.addEventListener("change",e=>setMode(e.target.value)); el.reset.addEventListener("click",()=>{ const keep=el.mode.value; st={p:0,c:0,r:0,stack:[],target:null,locked:false}; el.pPick.textContent="‚ùî"; el.cPick.textContent="‚ùî"; el.hist.innerHTML=""; setMode(keep); setMsg("Game reset. Make your move!"); renderScore(); }); el.undo.addEventListener("click",()=>{ if(!st.stack.length || st.locked) return; const last=st.stack.pop(); st.r=Math.max(0,st.r-1); if(last.out==="win") st.p=Math.max(0,st.p-1); if(last.out==="lose") st.c=Math.max(0,st.c-1); el.hist.firstElementChild?.remove(); setMsg("Last round undone."); renderScore(); }); setMode(el.mode.value); setMsg("Make your move!"); renderScore(); // SANDBOX MODE with FX: shockwave (rock), curl/peel (paper wrapping rock), trails (scissors) const arena = $("#arena"); const canvas = $("#sandbox"); const fxCanvas = $("#fx"); const dpr = Math.min(window.devicePixelRatio||1, 2); function resize(){ const rect = arena.getBoundingClientRect(); [canvas, fxCanvas].forEach(cv=>{ cv.width = Math.floor(rect.width*dpr); cv.height= Math.floor(rect.height*dpr); cv.style.width = rect.width+"px"; cv.style.height= rect.height+"px"; }); } resize(); new ResizeObserver(resize).observe(arena); const ctx = canvas.getContext("2d"); const fxc = fxCanvas.getContext("2d"); const COLORS = { rock:"var(--rock)", paper:"var(--paper)", scissors:"var(--scissors)" }; const TOK = []; const stats = { win:0, draw:0 }; let paused=false, autoCPU=false, speed=1; // Particles and effects const particles=[]; function colVar(key){ return getComputedStyle(document.documentElement).getPropertyValue(COLORS[key].replace("var","")).trim() || "#fff"; } function rand(min,max){ return Math.random()*(max-min)+min; } function particleDot(x,y,color,size,life,vx,vy){ particles.push({x,y,color,size,life,vx,vy,type:"dot"}); } function particleRing(x,y,color){ particles.push({x,y,color,r:2*dpr,max:70*dpr,life:28,type:"ring"}); } function particleTrail(x,y,color){ particles.push({x,y,color,size:rand(1,2)*dpr,life:20,type:"trail"}); } function drawFX(){ fxc.clearRect(0,0,fxCanvas.width,fxCanvas.height); for(let i=particles.length-1;i>=0;i--){ const p=particles[i]; if(p.type==="dot"){ p.life--; p.x+= (p.vx||0)*speed; p.y+= (p.vy||0)*speed; fxc.globalAlpha = Math.max(0,p.life/30); fxc.fillStyle=p.color; fxc.beginPath(); fxc.arc(p.x,p.y,p.size,0,Math.PI*2); fxc.fill(); if(p.life<=0) particles.splice(i,1); } else if(p.type==="ring"){ p.life--; p.r += 3.2*speed*dpr; const alpha = p.life/28; fxc.globalAlpha = Math.max(0,alpha); fxc.strokeStyle=p.color; fxc.lineWidth=3*dpr; fxc.beginPath(); fxc.arc(p.x,p.y,p.r,0,Math.PI*2); fxc.stroke(); if(p.r>=p.max || p.life<=0) particles.splice(i,1); } else if(p.type==="trail"){ p.life--; fxc.globalAlpha = Math.max(0,p.life/20); fxc.fillStyle=p.color; fxc.beginPath(); fxc.arc(p.x,p.y,p.size,0,Math.PI*2); fxc.fill(); if(p.life<=0) particles.splice(i,1); } } fxc.globalAlpha=1; } function centerBurst(color){ const rect=arena.getBoundingClientRect(); const cx = rect.width/2*dpr, cy = rect.height/2*dpr; for(let i=0;i<16;i++){ particleDot(cx, cy, color, rand(2,3.5)*dpr, 24, Math.cos(i)*rand(1,3)*dpr, Math.sin(i)*rand(1,3)*dpr); } } // Token model function spawn(type, x, y){ const w = canvas.width, h=canvas.height; const t = { id:Math.random().toString(36).slice(2), type, x: x!=null? x*dpr : rand(40*dpr, w-40*dpr), y: y!=null? y*dpr : rand(40*dpr, h-40*dpr), r: 22*dpr, vx: rand(-2,2)*dpr, vy: rand(-2,2)*dpr, grab:false, dead:false, curl: 0 // for paper peel animation }; TOK.push(t); updateStats(); // small burst on spawn for(let i=0;i<8;i++) particleDot(t.x,t.y,colVar(type),rand(1.2,2.2)*dpr,18,rand(-1.4,1.4)*dpr,rand(-1.4,1.4)*dpr); } // Drawing tokens + effects function roundedRect(c,x,y,w,h,r){ c.beginPath(); c.moveTo(x+r,y); c.arcTo(x+w,y,x+w,y+h,r); c.arcTo(x+w,y+h,x,y+h,r); c.arcTo(x,y+h,x,y,r); c.arcTo(x,y,x+w,y,r); c.closePath(); } function drawToken(t){ ctx.save(); ctx.shadowColor = "rgba(0,0,0,.12)"; ctx.shadowBlur = 10; if(t.type==="rock"){ ctx.fillStyle = colVar("rock"); roundedRect(ctx, t.x-t.r, t.y-t.r, t.r*2, t.r*2, 8*dpr); ctx.fill(); ctx.shadowBlur=0; ctx.globalAlpha=.14; ctx.fillStyle="#ffffff"; for(let i=0;i<3;i++){ const fx=t.x+rand(-t.r*.6,t.r*.6), fy=t.y+rand(-t.r*.6,t.r*.6); roundedRect(ctx, fx-6*dpr, fy-6*dpr, 12*dpr, 12*dpr, 4*dpr); ctx.fill(); } } else if(t.type==="paper"){ // curl/peel factor t.curl [0..1] const w=t.r*2, h=t.r*2; const curl = t.curl || 0; const flutter = Math.sin((performance.now()/550 + t.x + t.y)*0.003)*3*dpr; ctx.fillStyle = colVar("paper"); ctx.beginPath(); ctx.moveTo(t.x-w/2, t.y-h/2); ctx.lineTo(t.x+w/2-flutter, t.y-h/2); // bottom edge with a curled corner on the right when wrapping const curlWidth = curl * (w*0.5); ctx.lineTo(t.x+w/2, t.y+h/2); ctx.lineTo(t.x-w/2, t.y+h/2); ctx.closePath(); ctx.fill(); // right-corner curl overlay if(curl>0){ ctx.save(); ctx.globalAlpha = 0.8*curl; ctx.fillStyle = "#ffffff"; const cx = t.x+w/2 - curlWidth*0.4; const cy = t.y; roundedRect(ctx, cx-8*dpr, cy-16*dpr, 16*dpr, 32*dpr, 6*dpr); ctx.fill(); ctx.restore(); } // vertical fold sheen ctx.globalAlpha=.25; ctx.fillStyle="#fff"; ctx.fillRect(t.x-w/2, t.y-h/2, w*.35, h); } else if(t.type==="scissors"){ ctx.strokeStyle = colVar("scissors"); ctx.lineWidth = 6*dpr; ctx.beginPath(); ctx.arc(t.x-8*dpr, t.y, 10*dpr, 0, Math.PI*2); ctx.moveTo(t.x-8*dpr, t.y); ctx.lineTo(t.x+t.r-6*dpr, t.y-t.r+6*dpr); ctx.moveTo(t.x-8*dpr, t.y); ctx.lineTo(t.x+t.r-6*dpr, t.y+t.r-6*dpr); ctx.stroke(); // trail particles when moving fast const spd = Math.hypot(t.vx, t.vy); if(spd > 2.6*dpr){ particleTrail(t.x, t.y, colVar("scissors")); particleTrail(t.x-6*dpr, t.y-6*dpr, colVar("scissors")); } } ctx.restore(); } // Physics & interactions let drag = null; function step(){ if(!paused){ const w=canvas.width, h=canvas.height; TOK.forEach(t=>{ if(t.grab) return; t.x += t.vx*speed; t.y += t.vy*speed; // walls if(t.x<t.r){ t.x=t.r; t.vx*=-1 } if(t.x>w-t.r){ t.x=w-t.r; t.vx*=-1 } if(t.y<t.r){ t.y=t.r; t.vy*=-1 } if(t.y>h-t.r){ t.y=h-t.r; t.vy*=-1 } }); // collisions for(let i=0;i<TOK.length;i++){ for(let j=i+1;j<TOK.length;j++){ const a=TOK[i], b=TOK[j]; if(a.dead||b.dead) continue; const dx=b.x-a.x, dy=b.y-a.y, dist=Math.hypot(dx,dy), min=a.r+b.r; if(dist<min){ const nx=dx/(dist||1), ny=dy/(dist||1), overlap=min-dist; a.x-=nx*overlap/2; a.y-=ny*overlap/2; b.x+=nx*overlap/2; b.y+=ny*overlap/2; const tx=a.vx, ty=a.vy; a.vx=b.vx; a.vy=b.vy; b.vx=tx; b.vy=ty; // outcome const out = resolve(a.type, b.type); if(out==="A"){ resolveAbsorb(a,b); } else if(out==="B"){ resolveAbsorb(b,a); } else { stats.draw++; // minor bounce particles for(let k=0;k<6;k++) particleDot((a.x+b.x)/2,(a.y+b.y)/2,"#fbbf24",rand(1.5,3)*dpr,18,rand(-1.2,1.2)*dpr,rand(-1.2,1.2)*dpr); updateStats(); } } } } } // render ctx.clearRect(0,0,canvas.width,canvas.height); TOK.forEach(drawToken); drawFX(); requestAnimationFrame(step); } function resolve(a,b){ if(a===b) return "D"; if(a==="rock"&&b==="scissors") return "A"; if(a==="paper"&&b==="rock") return "A"; if(a==="scissors"&&b==="paper") return "A"; return "B"; } function resolveAbsorb(winner, loser){ // Rock winning: shockwave ring if(winner.type==="rock" && loser.type==="scissors"){ particleRing(loser.x, loser.y, "#9ca3af"); for(let i=0;i<20;i++) particleDot(loser.x,loser.y,"#ffd1e6",rand(1,3)*dpr,rand(16,30),rand(-2.2,2.2)*dpr,rand(-2.2,2.2)*dpr); } // Paper winning over Rock: start/boost curl animation on paper if(winner.type==="paper" && loser.type==="rock"){ const target = winner; target.curl = Math.min(1, (target.curl||0) + 0.6); // peel sparkles for(let i=0;i<14;i++) particleDot(loser.x,loser.y,"#cfe9ff",rand(1.2,2.4)*dpr,rand(18,34),rand(-1.6,1.6)*dpr,rand(-1.6,1.6)*dpr); // slowly decay curl over time const decay = () => { if (!TOK.includes(target)) return; target.curl = Math.max(0, (target.curl||0) - 0.01); if (target.curl>0) requestAnimationFrame(decay); }; requestAnimationFrame(decay); } // Scissors winning over Paper: lots of trailish sparks if(winner.type==="scissors" && loser.type==="paper"){ for(let i=0;i<18;i++) particleDot(loser.x,loser.y,"#ffd3f0",rand(1,2.5)*dpr,rand(14,26),rand(-2,2)*dpr,rand(-1.2,1.2)*dpr); } stats.win++; TOK.splice(TOK.indexOf(loser),1); winner.r = clamp(winner.r + 1.2*dpr, 12*dpr, 40*dpr); updateStats(); } function updateStats(){ $("#stats").textContent = `Wins: ${stats.win} - Draws: ${stats.draw} - Objects: ${TOK.length}`; } // Hit test and dragging function hit(x,y){ for(let i=TOK.length-1;i>=0;i--){ const t=TOK[i]; if(Math.hypot(x-t.x,y-t.y) <= t.r+6*dpr) return t; } return null; } let dragId=null, dragTok=null, offx=0, offy=0; function onDown(clientX, clientY){ const rect=canvas.getBoundingClientRect(), x=(clientX-rect.left)*dpr, y=(clientY-rect.top)*dpr; const t=hit(x,y); if(t){ dragTok=t; offx=x-t.x; offy=y-t.y; t.grab=true; } } function onMove(clientX, clientY){ if(!dragTok) return; const rect=canvas.getBoundingClientRect(), x=(clientX-rect.left)*dpr, y=(clientY-rect.top)*dpr; dragTok.x = x - offx; dragTok.y = y - offy; dragTok.vx *= .9; dragTok.vy *= .9; } function onUp(){ if(dragTok){ dragTok.grab=false; dragTok=null; } } canvas.addEventListener("mousedown", e=>onDown(e.clientX,e.clientY)); window.addEventListener("mousemove", e=>onMove(e.clientX,e.clientY)); window.addEventListener("mouseup", onUp); canvas.addEventListener("touchstart", e=>{ const t=e.changedTouches; onDown(t.clientX,t.clientY); e.preventDefault(); }, {passive:false}); canvas.addEventListener("touchmove", e=>{ const t=e.changedTouches; onMove(t.clientX,t.clientY); e.preventDefault(); }, {passive:false}); canvas.addEventListener("touchend", onUp); // Controls $$(".sbx-controls .chip[data-spawn]").forEach(b=>{ b.addEventListener("click",()=>spawn(b.dataset.spawn)); }); $("#clear").addEventListener("click",()=>{ TOK.length=0; stats.win=0; stats.draw=0; particles.length=0; updateStats(); }); $("#pause").addEventListener("click", (e)=>{ paused=!paused; e.currentTarget.textContent = paused ? "Resume" : "Pause"; }); $("#autoToggle").addEventListener("click",(e)=>{ autoCPU=!autoCPU; e.currentTarget.textContent = `Auto CPU: ${autoCPU?"On":"Off"}`; }); $("#speed").addEventListener("input",(e)=>{ speed = parseFloat(e.target.value)||1; }); // Auto spawner setInterval(()=>{ if(!autoCPU || paused) return; const t=["rock","paper","scissors"][Math.random()*3|0]; spawn(t); }, 900); // Start loop requestAnimationFrame(step); })(); </script> </body> </html>
